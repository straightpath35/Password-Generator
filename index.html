<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>üîê Password Tools ‚Äî Advanced</title>
<style>
  :root{
    --bg-1: linear-gradient(135deg,#667eea 0%,#764ba2 100%);
    --glass: rgba(255,255,255,0.08);
    --card: rgba(255,255,255,0.95);
    --text-dark: #1f2937;
    --accent: #5b6ef3;
    --success: #28a745;
    --danger: #dc3545;
    --muted: #6b7280;
    --glass-border: rgba(255,255,255,0.12);
  }
  [data-theme="dark"]{
    --glass: rgba(0,0,0,0.45);
    --card: rgba(17,24,39,0.85);
    --text-dark: #e6eef8;
    --muted: #9aa4b2;
    --glass-border: rgba(255,255,255,0.06);
  }

  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%}
  body{
    font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: var(--bg-1);
    display:flex;
    align-items:center;
    justify-content:center;
    padding:28px;
    color:var(--text-dark);
    transition: background .35s ease, color .35s ease;
  }

  .wrap{
    width:100%;
    max-width:920px;
    margin:auto;
    display:grid;
    grid-template-columns: 1fr 360px;
    gap:22px;
    align-items:start;
  }

  .card{
    background:var(--card);
    border-radius:14px;
    padding:18px;
    box-shadow: 0 10px 30px rgba(2,6,23,0.18);
    border: 1px solid var(--glass-border);
    backdrop-filter: blur(6px) saturate(120%);
    transition: transform .18s ease, box-shadow .18s ease;
  }
  .card:active{transform: translateY(1px)}
  header.header{
    display:flex;
    gap:16px;
    align-items:center;
  }
  .logo{
    width:72px;height:72px;border-radius:12px;
    display:flex;align-items:center;justify-content:center;
    background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
    font-size:28px;
    box-shadow: inset 0 -6px 18px rgba(255,255,255,0.02);
  }
  header h1{font-size:20px}
  header p{color:var(--muted);font-size:13px;margin-top:4px}

  /* generator area */
  .controls{margin-top:14px;display:grid;gap:12px}
  .row{display:flex;gap:10px;align-items:center}
  .row .col{flex:1}
  .label{font-weight:700;color:var(--muted);font-size:13px;margin-bottom:6px;display:block}
  input[type="range"]{width:100%}
  input[type="text"], input[type="password"], select{
    width:100%;padding:10px;border-radius:10px;border:1px solid var(--glass-border);
    background:transparent;color:inherit;font-size:15px;
  }
  .checkbox-row{display:flex;flex-wrap:wrap;gap:10px}
  .chk{
    display:flex;align-items:center;gap:8px;padding:8px 10px;border-radius:10px;border:1px solid var(--glass-border);
    background:var(--glass);cursor:pointer;font-weight:600;font-size:13px;
  }
  .btn{
    display:inline-block;padding:12px 14px;border-radius:12px;border:none;background:linear-gradient(90deg,var(--accent),#7b61ff);
    color:white;font-weight:700;cursor:pointer;width:100%;font-size:15px;
  }
  .btn.secondary{background:transparent;color:var(--text-dark);border:1px solid var(--glass-border);font-weight:700}

  .password-display{
    margin-top:12px;font-family:ui-monospace,SFMono-Regular,Menlo,monospace;background:linear-gradient(180deg, rgba(0,0,0,0.02), rgba(255,255,255,0.03));
    padding:12px;border-radius:10px;border:1px dashed var(--glass-border);word-break:break-all;display:flex;align-items:center;justify-content:space-between;gap:12px;
  }
  .pw-text{font-size:15px;flex:1}

  /* right column - history & checker */
  .right{
    display:flex;flex-direction:column;gap:14px;
    position:sticky;top:24px;
  }

  .history-list{display:flex;flex-direction:column;gap:8px;max-height:320px;overflow:auto;padding-right:6px}
  .history-item{display:flex;gap:10px;align-items:center;padding:10px;border-radius:10px;background:var(--glass);border:1px solid var(--glass-border);font-family:ui-monospace,monospace}
  .history-item button{border:none;background:transparent;cursor:pointer;font-weight:700}
  .small{font-size:13px;color:var(--muted)}

  /* strength meter */
  .strength-meter{height:10px;background:transparent;border-radius:8px;overflow:hidden;border:1px solid var(--glass-border)}
  .strength-fill{height:100%;width:0%;transition:width .3s ease,background .3s ease}

  .meter-veryweak{background:linear-gradient(90deg,#ff5f6d,#ff9966)}
  .meter-weak{background:linear-gradient(90deg,#ff7a59,#ffb86b)}
  .meter-fair{background:linear-gradient(90deg,#ffb86b,#ffd36b)}
  .meter-good{background:linear-gradient(90deg,#9be15d,#00e3a3)}
  .meter-strong{background:linear-gradient(90deg,#00c6ff,#0072ff)}

  /* toast */
  .toast-wrap{position:fixed;right:18px;bottom:18px;display:flex;flex-direction:column;gap:8px;z-index:9999}
  .toast{min-width:220px;background:var(--card);border-radius:10px;padding:10px 12px;border:1px solid var(--glass-border);box-shadow:0 8px 20px rgba(2,6,23,0.18);font-weight:700}

  /* footer */
  footer{margin-top:12px;font-size:13px;color:var(--muted);display:flex;justify-content:space-between;gap:10px;align-items:center}

  /* responsive */
  @media (max-width:880px){
    .wrap{grid-template-columns:1fr;max-width:740px}
    .right{position:relative;top:unset}
  }
</style>
</head>
<body data-theme="">
<div class="wrap">
  <!-- Left: Generator + header -->
  <div class="card">
    <header class="header">
      <div class="logo">üîê</div>
      <div>
        <h1>Password Tools ‚Äî Pro</h1>
        <p>Generate secure passwords ‚Ä¢ Check strength ‚Ä¢ Save history</p>
      </div>
      <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
        <button id="themeBtn" class="btn secondary" style="width:auto;padding:8px 10px">üåó Theme</button>
      </div>
    </header>

    <section class="controls" aria-label="Password generator">
      <div>
        <label class="label">Password Length <span id="lenLabel" class="small">12</span></label>
        <input id="lengthSlider" type="range" min="6" max="48" value="12" />
      </div>

      <div class="checkbox-row" role="group" aria-label="Character options">
        <label class="chk"><input id="uppercase" type="checkbox" checked style="display:none" />A-Z</label>
        <label class="chk"><input id="lowercase" type="checkbox" checked style="display:none" />a-z</label>
        <label class="chk"><input id="numbers" type="checkbox" checked style="display:none" />0-9</label>
        <label class="chk"><input id="symbols" type="checkbox" style="display:none" />Symbols</label>
      </div>

      <div class="row">
        <div class="col">
          <button id="generateBtn" class="btn">Generate Password</button>
        </div>
        <div style="width:120px">
          <button id="saveSettingBtn" class="btn secondary">Save</button>
        </div>
      </div>

      <div class="password-display" aria-live="polite">
        <div class="pw-text" id="generatedPassword">Your password will appear here</div>
        <div style="display:flex;flex-direction:column;gap:8px">
          <button id="copyBtn" class="btn secondary" style="width:120px">Copy</button>
          <button id="regenerateBtn" class="btn secondary" style="width:120px">Regenerate</button>
        </div>
      </div>

      <footer>
        <div class="small">Tip: click a history item to copy quickly</div>
        <div class="small">Built with ‚ù§Ô∏è ‚Äî public & free</div>
      </footer>
    </section>
  </div>

  <!-- Right column: History + Checker -->
  <div class="right">
    <div class="card">
      <h3 style="margin-bottom:8px">Password History</h3>
      <div style="display:flex;gap:8px;margin-bottom:10px">
        <button id="clearHistoryBtn" class="btn secondary" style="width:100%">Clear history</button>
        <button id="exportBtn" class="btn" style="width:130px">Export</button>
      </div>
      <div id="historyList" class="history-list" aria-live="polite"></div>
      <div style="margin-top:10px" class="small">Saved locally in your browser (private).</div>
    </div>

    <div class="card">
      <h3 style="margin-bottom:8px">Password Checker</h3>
      <input id="checkerInput" placeholder="Type or paste a password" aria-label="password to check" />
      <div style="margin-top:8px" class="small">Real-time strength feedback</div>
      <div style="margin-top:12px" class="strength-meter" aria-hidden="true">
        <div id="strengthFill" class="strength-fill"></div>
      </div>
      <div style="margin-top:8px;display:flex;gap:8px;align-items:center">
        <div id="strengthText" class="small" style="font-weight:800">‚Äî</div>
        <div style="margin-left:auto">
          <button id="suggestBtn" class="btn secondary" style="width:auto;padding:8px 10px">Suggest</button>
        </div>
      </div>

      <div style="margin-top:12px">
        <div class="small" style="font-weight:700">Requirements</div>
        <ul style="margin-top:8px;color:var(--muted);font-size:13px">
          <li id="reqLen">‚ùå At least 8 chars</li>
          <li id="reqUpper">‚ùå Uppercase</li>
          <li id="reqLower">‚ùå Lowercase</li>
          <li id="reqNum">‚ùå Number</li>
          <li id="reqSym">‚ùå Symbol</li>
        </ul>
      </div>
    </div>

    <div class="card" style="text-align:center">
      <div style="font-weight:800">Publish-ready</div>
      <div class="small" style="margin-top:6px">Your site is public ‚Äî share the link and show your work!</div>
      <div style="margin-top:10px;display:flex;gap:8px;justify-content:center">
        <button id="downloadAllBtn" class="btn secondary" style="width:auto">Download</button>
        <button id="resetBtn" class="btn" style="width:auto">Reset</button>
      </div>
    </div>
  </div>
</div>

<!-- toast container -->
<div class="toast-wrap" id="toastWrap" aria-live="polite"></div>

<script>
/* ========== Utilities ========== */
const $ = (sel) => document.querySelector(sel);
const $$ = (sel) => Array.from(document.querySelectorAll(sel));
const LS = window.localStorage;

/* ========== Elements ========== */
const lengthSlider = $('#lengthSlider');
const lenLabel = $('#lenLabel');
const uppercase = $('#uppercase');
const lowercase = $('#lowercase');
const numbers = $('#numbers');
const symbols = $('#symbols');
const generateBtn = $('#generateBtn');
const regenerateBtn = $('#regenerateBtn');
const copyBtn = $('#copyBtn');
const generatedPassword = $('#generatedPassword');
const historyList = $('#historyList');
const clearHistoryBtn = $('#clearHistoryBtn');
const exportBtn = $('#exportBtn');
const checkerInput = $('#checkerInput');
const strengthFill = $('#strengthFill');
const strengthText = $('#strengthText');
const reqLen = $('#reqLen');
const reqUpper = $('#reqUpper');
const reqLower = $('#reqLower');
const reqNum = $('#reqNum');
const reqSym = $('#reqSym');
const themeBtn = $('#themeBtn');
const saveSettingBtn = $('#saveSettingBtn');
const suggestBtn = $('#suggestBtn');
const downloadAllBtn = $('#downloadAllBtn');
const resetBtn = $('#resetBtn');
const toastWrap = $('#toastWrap');

/* ========== Config & Keys ========== */
const LS_KEYS = {
  HISTORY: 'pw_hist_v1',
  SETTINGS: 'pw_settings_v1',
  THEME: 'pw_theme_v1'
};
const HISTORY_MAX = 8;

/* ========== Default settings ========== */
const defaultSettings = {
  length: 12,
  uppercase: true,
  lowercase: true,
  numbers: true,
  symbols: false
};

/* ========== Theme ========== */
function setTheme(theme){
  document.body.setAttribute('data-theme', theme);
  LS.setItem(LS_KEYS.THEME, theme);
  showToast(`Theme: ${theme}`, {timeout: 1200});
}
(function initTheme(){
  const saved = LS.getItem(LS_KEYS.THEME) || 'light';
  setTheme(saved);
})();

/* ========== Toast ========== */
function showToast(text, {timeout=2000} = {}){
  const el = document.createElement('div');
  el.className = 'toast';
  el.textContent = text;
  toastWrap.appendChild(el);
  setTimeout(()=> el.style.opacity = 1, 10);
  setTimeout(()=> {
    el.style.opacity = 0;
    setTimeout(()=> el.remove(), 300);
  }, timeout);
}

/* ========== Settings (save / load) ========== */
function saveSettings(){
  const s = {
    length: Number(lengthSlider.value),
    uppercase: uppercase.checked,
    lowercase: lowercase.checked,
    numbers: numbers.checked,
    symbols: symbols.checked
  };
  LS.setItem(LS_KEYS.SETTINGS, JSON.stringify(s));
  showToast('Settings saved');
}
function loadSettings(){
  const raw = LS.getItem(LS_KEYS.SETTINGS);
  const s = raw ? JSON.parse(raw) : defaultSettings;
  lengthSlider.value = s.length || defaultSettings.length;
  lenLabel.textContent = lengthSlider.value;
  uppercase.checked = !!s.uppercase;
  lowercase.checked = !!s.lowercase;
  numbers.checked = !!s.numbers;
  symbols.checked = !!s.symbols;
}
loadSettings();

/* ========== History ========== */
function getHistory(){
  try {
    const raw = LS.getItem(LS_KEYS.HISTORY);
    return raw ? JSON.parse(raw) : [];
  } catch(e){ return [] }
}
function saveHistory(arr){
  LS.setItem(LS_KEYS.HISTORY, JSON.stringify(arr.slice(0, HISTORY_MAX)));
}
function addToHistory(pw){
  if(!pw || pw.trim()==='') return;
  let arr = getHistory();
  // avoid duplicates; newest first
  arr = arr.filter(x => x !== pw);
  arr.unshift(pw);
  if(arr.length > HISTORY_MAX) arr = arr.slice(0, HISTORY_MAX);
  saveHistory(arr);
  renderHistory();
}
function clearHistory(){
  LS.removeItem(LS_KEYS.HISTORY);
  renderHistory();
  showToast('History cleared');
}
function renderHistory(){
  const arr = getHistory();
  historyList.innerHTML = '';
  if(arr.length === 0){
    historyList.innerHTML = '<div class="small">No passwords yet ‚Äî generate one!</div>';
    return;
  }
  arr.forEach((pw, idx) => {
    const div = document.createElement('div');
    div.className = 'history-item';
    div.innerHTML = `
      <div style="flex:1;font-family:ui-monospace,monospace">${pw}</div>
      <div style="display:flex;flex-direction:column;gap:6px">
        <button title="Copy" data-copy="${idx}">Copy</button>
        <button title="Remove" data-remove="${idx}" style="color:var(--danger)">‚úï</button>
      </div>
    `;
    historyList.appendChild(div);
  });
}

/* delegate history clicks */
historyList.addEventListener('click', (e) => {
  const copyIdx = e.target.getAttribute('data-copy');
  const remIdx = e.target.getAttribute('data-remove');
  if(copyIdx != null){
    const arr = getHistory();
    const pw = arr[Number(copyIdx)];
    navigator.clipboard.writeText(pw);
    showToast('Copied from history');
  } else if(remIdx != null){
    let arr = getHistory();
    arr.splice(Number(remIdx),1);
    saveHistory(arr);
    renderHistory();
    showToast('Removed from history');
  } else {
    // click on item area -> copy
    const item = e.target.closest('.history-item');
    if(item){
      const pwText = item.querySelector('div').textContent.trim();
      if(pwText){
        navigator.clipboard.writeText(pwText);
        showToast('Copied');
      }
    }
  }
});

/* ========== Password generation ========== */
function generatePassword(opts){
  opts = opts || {
    length: Number(lengthSlider.value),
    uppercase: uppercase.checked,
    lowercase: lowercase.checked,
    numbers: numbers.checked,
    symbols: symbols.checked
  };

  const sets = {
    upper: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
    lower: 'abcdefghijklmnopqrstuvwxyz',
    num: '0123456789',
    sym: '!@#$%^&*()_+[]{}<>?/|~`-='
  };

  let pool = '';
  if(opts.uppercase) pool += sets.upper;
  if(opts.lowercase) pool += sets.lower;
  if(opts.numbers) pool += sets.num;
  if(opts.symbols) pool += sets.sym;

  if(!pool){
    showToast('Select at least one character type', {timeout:2000});
    return '';
  }

  // guarantee at least one of selected types appears (more secure generator)
  const guaranteed = [];
  if(opts.uppercase) guaranteed.push(randomFrom(sets.upper));
  if(opts.lowercase) guaranteed.push(randomFrom(sets.lower));
  if(opts.numbers) guaranteed.push(randomFrom(sets.num));
  if(opts.symbols) guaranteed.push(randomFrom(sets.sym));

  let pwArr = [];
  for(let i=0;i<opts.length - guaranteed.length;i++){
    pwArr.push(randomFrom(pool));
  }
  // insert guaranteed chars
  pwArr = pwArr.concat(guaranteed);
  // shuffle
  pwArr = shuffleArray(pwArr);
  const pw = pwArr.join('');
  generatedPassword.textContent = pw;
  addToHistory(pw);
  showToast('Password generated');
  return pw;
}

function randomFrom(str){
  return str.charAt(Math.floor(Math.random()*str.length));
}
function shuffleArray(a){
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

/* ========== Copy & regen ========== */
copyBtn.addEventListener('click', async ()=>{
  const pw = generatedPassword.textContent.trim();
  if(!pw || pw === 'Your password will appear here') {
    showToast('No password to copy', {timeout:1200});
    return;
  }
  await navigator.clipboard.writeText(pw);
  showToast('Copied to clipboard');
});
regenerateBtn.addEventListener('click', ()=> generatePassword());

generateBtn.addEventListener('click', ()=> {
  const pw = generatePassword();
  updateChecker(pw);
});

/* ========== Strength checker ========== */
function calcStrength(pw){
  let score = 0;
  if(pw.length >= 8) score++;
  if(/[A-Z]/.test(pw)) score++;
  if(/[a-z]/.test(pw)) score++;
  if(/[0-9]/.test(pw)) score++;
  if(/[^A-Za-z0-9]/.test(pw)) score++;
  return score; // 0..5
}
function updateChecker(pw){
  pw = pw || checkerInput.value || '';
  const score = calcStrength(pw);
  const pct = Math.min(100, (score/5)*100);
  strengthFill.style.width = pct + '%';
  strengthFill.className = 'strength-fill';
  if(score <= 1){
    strengthText.textContent = 'Very weak';
    strengthFill.classList.add('meter-veryweak');
  } else if(score === 2){
    strengthText.textContent = 'Weak';
    strengthFill.classList.add('meter-weak');
  } else if(score === 3){
    strengthText.textContent = 'Fair';
    strengthFill.classList.add('meter-fair');
  } else if(score === 4){
    strengthText.textContent = 'Good';
    strengthFill.classList.add('meter-good');
  } else {
    strengthText.textContent = 'Excellent';
    strengthFill.classList.add('meter-strong');
  }

  // requirements
  reqLen.textContent = (pw.length >= 8 ? '‚úÖ' : '‚ùå') + ' At least 8 chars';
  reqUpper.textContent = (/[A-Z]/.test(pw) ? '‚úÖ' : '‚ùå') + ' Uppercase';
  reqLower.textContent = (/[a-z]/.test(pw) ? '‚úÖ' : '‚ùå') + ' Lowercase';
  reqNum.textContent = (/[0-9]/.test(pw) ? '‚úÖ' : '‚ùå') + ' Number';
  reqSym.textContent = (/[^A-Za-z0-9]/.test(pw) ? '‚úÖ' : '‚ùå') + ' Symbol';
}
checkerInput.addEventListener('input', ()=> updateChecker());

/* suggest (make a strong suggestion) */
suggestBtn.addEventListener('click', ()=>{
  // make a high-quality suggestion with many categories
  const suggested = generatePassword({length: 16, uppercase:true, lowercase:true, numbers:true, symbols:true});
  checkerInput.value = suggested;
  updateChecker(suggested);
  showToast('Suggestion created (16 chars)');
});

/* export & download */
exportBtn.addEventListener('click', ()=>{
  const arr = getHistory();
  if(arr.length === 0) { showToast('Nothing to export'); return; }
  const blob = new Blob([JSON.stringify(arr, null, 2)], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'password-history.json'; a.click();
  URL.revokeObjectURL(url);
  showToast('Exported history');
});

downloadAllBtn.addEventListener('click', ()=>{
  const html = document.documentElement.outerHTML;
  const blob = new Blob([html], {type:'text/html'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'password-tools-page.html'; a.click();
  URL.revokeObjectURL(url);
  showToast('Downloaded current page');
});

/* clear history & reset */
clearHistoryBtn.addEventListener('click', ()=> {
  if(confirm('Clear saved history?')) clearHistory();
});
resetBtn.addEventListener('click', ()=> {
  if(!confirm('Reset everything (settings + history + theme)?')) return;
  LS.removeItem(LS_KEYS.HISTORY);
  LS.removeItem(LS_KEYS.SETTINGS);
  LS.removeItem(LS_KEYS.THEME);
  loadSettings();
  renderHistory();
  setTheme('light');
  showToast('Reset complete');
});

/* save settings */
saveSettingBtn.addEventListener('click', saveSettings);

/* theme toggle button */
themeBtn.addEventListener('click', ()=>{
  const current = document.body.getAttribute('data-theme') || 'light';
  const next = current === 'light' ? 'dark' : 'light';
  setTheme(next);
});

/* length slider live label */
lengthSlider.addEventListener('input', ()=>{
  lenLabel.textContent = lengthSlider.value;
});

/* clickable chk labels toggle underlying input */
$$('.chk').forEach(el=>{
  el.addEventListener('click', ()=> {
    const inp = el.querySelector('input');
    inp.checked = !inp.checked;
    el.style.opacity = inp.checked ? 1 : 0.7;
  });
});

/* import history if file provided (drag & drop could be added) */
window.addEventListener('DOMContentLoaded', ()=>{
  renderHistory();
  // load saved settings into UI
  loadSettings();
  // first generated password if none
  if(getHistory().length === 0){
    generatePassword();
  } else {
    // display most recent in main display for convenience
    const cur = getHistory()[0];
    if(cur) generatedPassword.textContent = cur;
  }
  // apply initial checker preview
  updateChecker(checkerInput.value);
});

/* small helpers for keyboard accessibility */
document.addEventListener('keydown', (e)=>{
  if(e.ctrlKey && e.key.toLowerCase() === 'g'){ // Ctrl+G generate
    e.preventDefault(); generateBtn.click();
  } else if(e.ctrlKey && e.key.toLowerCase() === 'c'){ // Ctrl+C copy (when focus on display)
    if(document.activeElement === generatedPassword) copyBtn.click();
  }
});
</script>
</body>
</html>
